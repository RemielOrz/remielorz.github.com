<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>remiel</title>
	<link rel="stylesheet/less" type="text/css" href="style/eTask.less">
	<script type="text/javascript" src="js/less-1.3.0.min.js"></script>
	<style type="text/css">
		html, body {height: 100%; width: 100%; background: #000; position: relative;}
		#myCanvas{left:0;position:absolute;top:0;}
	</style>
</head>
<body onload="init()">
<canvas id="myCanvas"></canvas>
<!-- <script type="text/javascript" src="js/jquery-1.7.min.js"></script> -->
	<script type="text/javascript">var createjs = window;</script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/preloadjs-0.2.0.min.js"></script>
	<script type="text/javascript" src="js/easeljs-0.5.0.min.js"></script>
	<script type="text/javascript" src="js/tweenjs-0.3.0.min.js"></script>
	<script type="text/javascript" src="js/soundjs-0.3.0.min.js"></script>
<script type="text/javascript">
        var canvas;
        var stage;
        var tweens;
        var activeCount;
        var circleCount = 25;
        var text;

        function init() {
	       $('#myCanvas').attr({'width':$('body').width()+'px','height':$('body').height()})

			// begin loading content (only sounds to load)
			var manifest = [
				{id:"music", src:"http://f3.xiami.net/4/131/59831/485390/01_1770711694_2980769.mp3|./music/feelingtrust.ogg"}
			];

			var preload;

		    preload = new createjs.PreloadJS();
		    //Install SoundJS as a plugin, then PreloadJS will initialize it automatically.
		    preload.installPlugin(createjs.SoundJS);

		    //Available PreloadJS callbacks
		    preload.onFileLoad = function(event) {
			    // Show the icon on loaded items.
				//var div = document.getElementById(event.id);
			    //div.style.backgroundImage = "url('assets/audioButtonSheet.png')";
		    };
			preload.onComplete = function(event) {
				//document.getElementById("loader").className = "";
			}

		    //Load the manifest and pass 'true' to start loading immediately. Otherwise, you can call load() manually.
		    preload.loadManifest(manifest, true);
		    createjs.SoundJS.play("music");



            canvas = document.getElementById("myCanvas");
            stage = new createjs.Stage(canvas);
            tweens = [];
            stage.enableMouseOver(10);
			createjs.Touch.enable(stage);

            for (var i=0; i<circleCount; i++) {
                // draw the circle, and put it on stage:
                var circle = new createjs.Shape();
                circle.graphics.setStrokeStyle(15);
                //circle.graphics.beginStroke("#113355");
                circle.graphics.beginStroke(Q[Math.random(0,7)]);
                circle.graphics.drawCircle(0,0,(i+1)*4);
                circle.alpha = 1-i*0.02;
                circle.x = Math.random()*550;
                circle.y = Math.random()*400;
                circle.compositeOperation = "lighter";

                var tween = createjs.Tween.get(circle).to({x:275,y:200}, (0.5+i*0.04)*1500, createjs.Ease.bounceOut).call(tweenComplete);
                tweens.push({tween:tween, ref:circle});
                stage.addChild(circle);
            }
            activeCount = circleCount;
            stage.onMouseUp = handleMouseUp;

	        text = new createjs.Text("remiel.me", "36px Arial", "#42a8cb");
	        text.x = 450;
	        text.y = 200;
	        stage.addChild(text);

			createjs.Ticker.addListener(window);
        }


        function handleMouseUp(event) {
        	//var _x;
	        //stage.mouseX > canvas.offsetWidth/2?_x = 0:_x = -180;
	        if (text) {
	        	stage.removeChild(text);
	        	text = null;
	        	//console.log(text);
	        	//console.log(createjs.Tween.get(text,{override:true}));
	        }

            for (var i=0; i<circleCount; i++) {
                var ref = tweens[i].ref;
                var tween = tweens[i].tween;

                //text.color = Q[Math.random(0,6)];
                //text.font = Math.random(12,72)+ "px Arial";
        		//createjs.Tween.get(text,{override:true}).to({color:Q[Math.random(0,6)],x:canvas.offsetWidth-stage.mouseX+_x,y:stage.mouseY}, (0.2+i*0.04)*1500, createjs.Ease.bounceOut);
				createjs.Tween.get(ref,{override:true}).wait(2).to({x:stage.mouseX,y:stage.mouseY}, (0.5+i*0.04)*1500, createjs.Ease.bounceOut).call(tweenComplete);
            }
            activeCount = circleCount;
        }

        function tweenComplete() {
            activeCount--;
        }

        function tick() {
            if (activeCount) { stage.update(); }
        }


		var native_random = Math.random;
		Math.random = function(a, b, c) {
		    if (arguments.length === 0)
		        return native_random();
		    arguments.length === 1 && (b = a, a = 0);
		    var d = a + native_random() * (b - a);
		    return c === void 0 ? Math.round(d) : d.toFixed(c)
		}
		Q = ["#42a8cb", "#ee823d", "#cb9bce", "#a8a9a8", "#3b8d3a", "#1e4484", "#c0000b", "#113355"]
</script>

<script type="text/javascript">
	

</script>
</body>
</html>